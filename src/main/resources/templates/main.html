<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultrq.net.nz/thymeleaf/layout"
      layout:decorator="fragments/default_layout">
<html lang="en" xmlns:v-on="http://www.w3.org/1999/xhtml" xmlns:v-bind="http://www.w3.org/1999/xhtml">
<meta charset="UTF-8">

<th:block layout:fragment="content">
  <body>

  <!-- 내용 시작. container에 크기를 지정하거나 추가 div 컨테이너 생성 후 제작하세요. -->
  <div class="container" style="margin-top: 60px">

    <p id="myLocation" style="display: none"></p>

    <script>
      var loc = document.getElementById("myLocation");
      var a;
      var b;
      window.onload =
              function findLocation() {
                if (navigator.geolocation) {
                  navigator.geolocation.getCurrentPosition(showYourLocation, showErrorMsg);
                } else {
                  loc.innerHTML = "GPS거부";
                }
              }

      function showYourLocation(position) {
        loc.innerHTML = "현재 사용자는 위도 " + position.coords.latitude + ", 경도 " + position.coords.longitude + "에 위치하고 있습니다.";
        a = position.coords.latitude;
        b = position.coords.longitude;
      }

      function showErrorMsg(error) {
        switch(error.code) {
          case error.PERMISSION_DENIED:
            loc.innerHTML = "GPS거부"
            break;
          case error.POSITION_UNAVAILABLE:
            loc.innerHTML = "위치정보 오류"
            break;
          case error.TIMEOUT:
            loc.innerHTML = "시간초과"
            break;
          case error.UNKNOWN_ERROR:
            loc.innerHTML = "알 수 없는 오류"
            break;
        }
      }
    </script>
    <script>








      $(function(){
        $("#checkJson").click(function(){
          var key = 'd6228f1b95c1595ea5148ff549a36b1b';
         /* alert(a);
          alert(b);*/
          var fwding = 'https://api.openweathermap.org/data/2.5/weather?lat='+a;
          fwding += '&lon='+b;
          fwding += '&appid=' + key;

          $.ajax({
            type : "GET",
            url : fwding, // 1. 요청
            dataType : "json",
            success: function(data, textStatus){
              /*alert(data.weather[0].main == 'Clear');*/
              $('#locName').text(data.name);
              var absoluteTemp = data.main.temp;
              var celsiusTemp = absoluteTemp - 273.15;
              $('#temperature').text(Math.floor(celsiusTemp)+"°C");

              if(data.weather[0].main == 'Clear'){
                $('#weatherInfo').text('<img th:src="@{/weahter/clear.png}" width="20px" />');
              }
              if(data.weather[0].main == 'few clouds'){
                $('#weatherInfo').text('<img th:src="@{weahter/few-clouds.png}" width="20px" />');
              }
              if(data.weather[0].main == 'rain'){
                $('#weatherInfo').text('<img th:src="@{/weahter/rain.png}" width="20px" />');
              }
              if(data.weather[0].main == 'overcast clouds'){
                $('#weatherInfo').text('<img th:src="@{/weahter/overcast-clouds.png}" width="20px" />');
              }

              $('#weatherInfo').text(data.weather[0].main);




              console.log("날씨 정보 시작");
              console.log(data);
              const keys = Object.keys(data);
              console.log(keys);
              console.log('종료');
            },
            error : function(data, textStatus){
              $('#locName').text("에러가 발생했습니다.");
            },
            complete : function (data, textStatus) {

            }
          }); //ajax END
        }); // click END
      }); // function END


    </script>
    <!--<input type="button" id="checkJson" value="회원 정보 보내기"  />-->








    <div id="logo">
      <p><a th:href="@{/hgyr}"><img src="./img/2main.png" width="350px" /></a></p>
    </div>
    <div class="search">
      <p><input type="text" size="50" id="searchBar" />&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" value="검색" id="searchBtn"/></p>
    </div>
    <div id="serviceTable">
      <table>
        <tr>
          <div>
            <td><a th:href="@{http://localhost:2111}"><img src="./img/Artboard 1.png" class="icons" width="100px" /></a></td>
            <td><a th:href="@{http://localhost:2112/minigame}"><img src="./img/Artboard 2.png" class="icons" width="100px" /></a></td>
            <td><a th:href="@{http://localhost:1999/chat/room}"><img src="./img/Artboard 3.png" class="icons" width="100px" /></a></td>
              <td><a th:href="@{http://localhost:2113/receivelist}"><img src="./img/Artboard 4.png" class="icons" width="100px" /></a></td>
            <td><a th:href="@{/hgyr}"><img src="./img/Artboard 5.png" class="icons" width="100px" /></a></td>
          </div>
        </tr>
        <tr>
          <div>
            <td class="apps">블로그</td>
            <td class="apps">게임</td>
            <td class="apps">스포츠</td>
            <td class="apps">쪽지</td>
            <td class="apps">베팅</td>
          </div>
        </tr>
      </table>
    </div>

  </div> <!-- 내용 끝나는 부분 -->

  </body>
</th:block>
</html>