<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultrq.net.nz/thymeleaf/layout"
      layout:decorator="fragments/default_layout">
<meta charset="UTF-8">
<th:block layout:fragment="content">
    <body>

    <!-- 내용 시작. container에 크기를 지정하거나 추가 div 컨테이너 생성 후 제작하세요. -->
    <div class="container px-5 my-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <h3>수신 메시지</h3>

                <div class="card shadow">
                    <div class="card-body">
                        <div class="form-group mb-3">
                            <label for="sendId">발신 아이디</label>
                            <div class="input-group">
                                <input type="text" id="sendId" name="sendId" class="form-control" th:value="${receive.sendId}" disabled />
                            </div>
                        </div>

                        <div class="form-group mb-3">
                            <label for="sendDate">수신시간</label>
                            <input type="text" id="sendDate" name="sendDate" class="form-control" th:value="${#temporals.format(receive.sendDate, 'yyyy-MM-dd HH:mm')}" disabled />
                        </div>

                        <div class="form-group mb-3">
                            <label for="title">제목</label>
                            <input type="text" id="title" name="title" class="form-control" th:value="${receive.title}" disabled />
                        </div>

                        <div class="form-group mb-3">
                            <label for="content">내용</label>
                            <textarea class="form-control" style="width:100%; height:200px; resize:none;" cols="50" rows="5" id="content" name="content" th:text="${receive.content}" disabled></textarea>
                        </div>
                        <div class="form-group d-flex justify-content-end align-items-center">
                            <div class="mb-3">
                                <div class="text-right">
                                    <button type="button" class="btn btn-outline-secondary" id="back" onclick="goBack()">돌아가기</button>
                                    <button class="btn btn-secondary"  th:id="${receive.id}" th:onclick="'confirmDelete(event, ' + ${receive.id} + ')'" >삭제</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <script>
        // 뒤로가기 함수
        function goBack() {
            window.history.back();
        }

        // 삭제하기
        function confirmDelete(event, id) {
            event.preventDefault();

            if (confirm('정말 삭제하시겠습니까?')) {

                var dataToSend = JSON.stringify([id]);

                $.ajax({
                    type:'POST',
                    url:'/receiveDelete',
                    contentType: 'application/json',
                    data: dataToSend,
                    success: function (data) {
                        alert(data);
                        window.location.href = "/receivelist";
                    },
                    error: function(xhr, status, error) {
                        alert("에러가 발생했습니다.");
                    }
                });
            }
        }


    </script>


    </body>
</th:block>
</html>